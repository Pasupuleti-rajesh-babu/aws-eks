# aws-eks
<header>
<h1 class="p-name">Deployment Of PHP Website On the Top Of AWS EKS Along with Prometheus And Grafana</h1>
</header>
<section data-field="subtitle" class="p-summary">
eksctl
</section>
<section data-field="body" class="e-content">
<section name="dd73" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="9760" id="9760" class="graf graf--h3 graf--leading graf--title">Deployment Of PHP Website On the Top Of AWS EKS Along with Prometheus And Grafana</h3><figure name="5484" id="5484" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 371px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53%;"></div><img class="graf-image" data-image-id="1*0EkxaCS4hXs-VZFMySTMMw.png" data-width="6719" data-height="3560" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*0EkxaCS4hXs-VZFMySTMMw.png"></div></figure><h3 name="d4eb" id="d4eb" class="graf graf--h3 graf-after--figure">Introduction</h3><p name="2c51" id="2c51" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--h3"><span class="graf-dropCap">A</span><em class="markup--em markup--p-em">mazon Elastic Kubernetes Service (Amazon EKS) is a managed service that makes it easy for you to run Kubernetes on AWS without needing to stand up or maintain your own Kubernetes control plane. Kubernetes is an open-source system for automating the deployment, scaling, and management of containerized applications.</em></p><p name="97f9" id="97f9" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">Amazon EKS runs Kubernetes control plane instances across multiple Availability Zones to ensure high availability. Amazon EKS automatically detects and replaces unhealthy control plane instances, and it provides automated version upgrades and patching for them.</em></p><p name="b0ee" id="b0ee" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">Amazon EKS is also integrated with many AWS services to provide scalability and security for your applications, including the following:</em></p><ul class="postList"><li name="dd52" id="dd52" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">Amazon ECR for container images</em></strong></li><li name="d059" id="d059" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">Elastic Load Balancing for load distribution</em></strong></li><li name="8de9" id="8de9" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">IAM for authentication</em></strong></li><li name="8cc0" id="8cc0" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">Amazon VPC for isolation</em></strong></li></ul><p name="23fe" id="23fe" class="graf graf--p graf-after--li"><em class="markup--em markup--p-em">Amazon EKS runs up-to-date versions of the open-source Kubernetes software, so you can use all the existing plugins and tooling from the Kubernetes community. Applications running on Amazon EKS are fully compatible with applications running on any standard Kubernetes environment, whether running in on-premises data centers or public clouds. This means that you can easily migrate any standard Kubernetes application to Amazon EKS without any code modification required.</em></p><h3 name="46fb" id="46fb" class="graf graf--h3 graf-after--p">Benefits</h3><ul class="postList"><li name="261b" id="261b" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">High Availability</strong></li><li name="f76b" id="f76b" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Serverless Option</strong></li><li name="f78d" id="f78d" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">secure</strong></li><li name="dea0" id="dea0" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Built with community</strong></li></ul><h3 name="d768" id="d768" class="graf graf--h3 graf-after--li">How it works</h3><figure name="ab27" id="ab27" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 365px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 52.2%;"></div><img class="graf-image" data-image-id="1*CKMOdVjiBdIWJUEvdjaIOg.png" data-width="2892" data-height="1510" src="https://cdn-images-1.medium.com/max/800/1*CKMOdVjiBdIWJUEvdjaIOg.png"></div></figure><h4 name="1062" id="1062" class="graf graf--h4 graf-after--figure">Companies adopting Amazon EKS</h4><figure name="5ae0" id="5ae0" class="graf graf--figure graf-after--h4"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 371px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53%;"></div><img class="graf-image" data-image-id="1*nACtPiUsYFxmE3Ktixuv9g.png" data-width="2858" data-height="1514" src="https://cdn-images-1.medium.com/max/800/1*nACtPiUsYFxmE3Ktixuv9g.png"></div></figure><h3 name="dd97" id="dd97" class="graf graf--h3 graf-after--figure">Prerequisites</h3><ul class="postList"><li name="0963" id="0963" class="graf graf--li graf-after--h3"><em class="markup--em markup--li-em">Installing AWS CLI -The AWS Command Line Interface (CLI) is a unified tool to manage your AWS services. With just one tool to download and configure, you can control multiple AWS services from the command line and automate them through scripts.</em></li><li name="5ff7" id="5ff7" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">Kubernetes uses a command-line utility called kubectl for communicating with the cluster API server. The kubectl binary is available in many operating system package managers, and this option is often much easier than a manual download and install process.</em></li><li name="fd68" id="fd68" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code"><strong class="markup--strong markup--li-strong"><em class="markup--em markup--li-em">eksctl</em></strong></code><em class="markup--em markup--li-em"> is a simple CLI tool for creating clusters on EKS - Amazon&#39;s new managed Kubernetes service for EC2. It is written in Go, uses CloudFormation, was created by </em><a href="https://www.weave.works/" data-href="https://www.weave.works/" class="markup--anchor markup--li-anchor" rel="noopener nofollow noopener" target="_blank"><em class="markup--em markup--li-em">Weaveworks</em></a><em class="markup--em markup--li-em"> and it welcomes contributions from the community. Install using this git </em><a href="https://github.com/weaveworks/eksctl" data-href="https://github.com/weaveworks/eksctl" class="markup--anchor markup--li-anchor" rel="noopener nofollow noopener" target="_blank"><em class="markup--em markup--li-em">URL</em></a><em class="markup--em markup--li-em">.</em></li><li name="11c9" id="11c9" class="graf graf--li graf-after--li"><em class="markup--em markup--li-em">AWS CLI must be configured with you IAM or ROOT user and it also has the power to use the Roles service in AWS, for this, I suggest you create an IAM user with administrative access.</em></li></ul><h3 name="733a" id="733a" class="graf graf--h3 graf-after--li">Weaveworks</h3><div name="2a47" id="2a47" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://www.weave.works/" data-href="https://www.weave.works/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://www.weave.works/"><strong class="markup--strong markup--mixtapeEmbed-strong">Weave Cloud</strong><br><em class="markup--em markup--mixtapeEmbed-em">Weaveworks has been working with enterprises of all shapes and sizes to implement their Kubernetes platforms, across…</em>www.weave.works</a><a href="https://www.weave.works/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="fe2c6972fcebba0d761fd881b0a3a01e" data-thumbnail-img-id="0*0wI9btPOvswr_UiT" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*0wI9btPOvswr_UiT);"></a></div><div name="e34e" id="e34e" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://github.com/weaveworks/eksctl" data-href="https://github.com/weaveworks/eksctl" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/weaveworks/eksctl"><strong class="markup--strong markup--mixtapeEmbed-strong">weaveworks/eksctl</strong><br><em class="markup--em markup--mixtapeEmbed-em">eksctl is a simple CLI tool for creating clusters on EKS — Amazon’s new managed Kubernetes service for EC2. It is…</em>github.com</a><a href="https://github.com/weaveworks/eksctl" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="7adc0d182d31af243aae1e087a6d1d0f" data-thumbnail-img-id="0*Z5-E3cVOzx2n-d_4" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*Z5-E3cVOzx2n-d_4);"></a></div><h3 name="6c2b" id="6c2b" class="graf graf--h3 graf-after--mixtapeEmbed">Create an IAM</h3><p name="89bf" id="89bf" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">Add permissions </em><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">AdministratorAccess</em></strong></p><figure name="5d84" id="5d84" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*7IYnombxzhOK3h5PJ5OIOg.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*7IYnombxzhOK3h5PJ5OIOg.png"></div></figure><h3 name="dc2b" id="dc2b" class="graf graf--h3 graf-after--figure">Cluster Creation</h3><p name="e910" id="e910" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">Create a cluster just with one command and cluster can be created either by YAML file or by using CLI. Now, we will be doing using the YAML file and the requirements for creating a cluster you can put it in YAML file</em></p><figure name="5316" id="5316" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 505px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 72.2%;"></div><img class="graf-image" data-image-id="1*wP8fJv5A6xZjzgrblkTesw.png" data-width="1360" data-height="982" src="https://cdn-images-1.medium.com/max/800/1*wP8fJv5A6xZjzgrblkTesw.png"></div></figure><pre name="8d05" id="8d05" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">apiVersion: eksctl.io/v1alpha5<br>kind: ClusterConfigmetadata:<br>  name: ekscluster<br>  region: ap-south-1nodeGroups:<br>   - name: ng1<br>     desiredCapacity: 4<br>     instanceType: t2.micro<br>     ssh:<br>        publicKeyName:  ekskey</strong></pre><p name="95c1" id="95c1" class="graf graf--p graf-after--pre"><em class="markup--em markup--p-em">After creating this file we have to use a single command which will create entire Kubernetes setup.</em></p><pre name="2c91" id="2c91" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">eksctl create cluster -f cluster.yml</strong></pre><figure name="61f0" id="61f0" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 461px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.9%;"></div><img class="graf-image" data-image-id="1*aYpDU9iXVNbT7e45Oer47w.png" data-width="2128" data-height="1402" src="https://cdn-images-1.medium.com/max/800/1*aYpDU9iXVNbT7e45Oer47w.png"></div></figure><figure name="0f65" id="0f65" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*iUebbEr-tdciVwT164A-8Q.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*iUebbEr-tdciVwT164A-8Q.png"></div><figcaption class="imageCaption">EKS&gt;clusters</figcaption></figure><figure name="19a2" id="19a2" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*OSPw5ZtSsO1zNVUdYV4NNA.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*OSPw5ZtSsO1zNVUdYV4NNA.png"></div><figcaption class="imageCaption">cluster configuration</figcaption></figure><figure name="3a58" id="3a58" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*wBIQ_uPpFkMCXnq0vXx64w.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*wBIQ_uPpFkMCXnq0vXx64w.png"></div><figcaption class="imageCaption">EC2 instance</figcaption></figure><pre name="af66" id="af66" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">eksctl get cluster</strong></pre><pre name="cc45" id="cc45" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">aws eks update-kubeconfig --name &lt;cluster name&gt;</strong></pre><pre name="b6a0" id="b6a0" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">kubectl get nodes</strong></pre><figure name="ff49" id="ff49" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 256px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 36.5%;"></div><img class="graf-image" data-image-id="1*On1JVta8sxsiGgr51LLLiA.png" data-width="1768" data-height="646" src="https://cdn-images-1.medium.com/max/800/1*On1JVta8sxsiGgr51LLLiA.png"></div></figure><h3 name="0137" id="0137" class="graf graf--h3 graf-after--figure">Creating a PHP website using MYSQL Database</h3><p name="926c" id="926c" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">Kubectl supports the management of Kubernetes objects using a kustomization file. You can create a Secret by generators in kustomization.yaml.</em></p><figure name="bc57" id="bc57" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 439px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 62.7%;"></div><img class="graf-image" data-image-id="1*0N8Vm2EHpSAXz73_V3jSHQ.png" data-width="1234" data-height="774" src="https://cdn-images-1.medium.com/max/800/1*0N8Vm2EHpSAXz73_V3jSHQ.png"></div></figure><pre name="402d" id="402d" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">apiVersion: kustomize.config.k8s.io/v1beta1<br>kind: Kustomization<br>secretGenerator:<br>  - name: mysql-pass<br>    literals:<br>        - password=redhat<br>resources:<br>  - mysql-deployment.yaml<br>  - wordpress-deployment.yaml</strong></pre><h3 name="e161" id="e161" class="graf graf--h3 graf-after--pre">Manifest for SQL-deployment</h3><p name="4127" id="4127" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">the manifest describes a single-instance MySQL Deployment. The MySQL container mounts the PersistentVolume at /var/lib/mysql. The MYSQL_ROOT_PASSWORD environment variable sets the database password from the Secret.</em></p><figure name="7454" id="7454" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 1445px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 206.4%;"></div><img class="graf-image" data-image-id="1*z_3VtV4IpDcC3ZRuWYY4MA.png" data-width="904" data-height="1866" src="https://cdn-images-1.medium.com/max/800/1*z_3VtV4IpDcC3ZRuWYY4MA.png"></div></figure><pre name="38bf" id="38bf" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">apiVersion: v1<br>kind: Service<br>metadata:<br>  name: wordpress-mysql<br>  labels:<br>    app: wordpress<br>spec:<br>  ports:<br>    - port: 3306<br>  selector:<br>    app: wordpress<br>    tier: mysql<br>  clusterIP: None<br>---<br>apiVersion: v1<br>kind: PersistentVolumeClaim<br>metadata:<br>  name: mysql-pv-claim<br>  labels:<br>    app: wordpress<br>spec:<br>  accessModes:<br>    - ReadWriteOnce<br>  resources:<br>    requests:<br>      storage: 5Gi<br>---<br>apiVersion: apps/v1<br>kind: Deployment<br>metadata:<br>  name: wordpress-mysql<br>  labels:<br>    app: wordpress<br>spec:<br>  selector:<br>    matchLabels:<br>      app: wordpress<br>      tier: mysql<br>  strategy:<br>    type: Recreate<br>  template:<br>    metadata:<br>      labels:<br>        app: wordpress<br>        tier: mysql<br>    spec:<br>      containers:<br>      - image: mysql:5.6<br>        name: mysql<br>        env:<br>        - name: MYSQL_ROOT_PASSWORD<br>          valueFrom:<br>            secretKeyRef:<br>              name: mysql-pass<br>              key: password<br>        ports:<br>        - containerPort: 3306<br>          name: mysql<br>        volumeMounts:<br>        - name: mysql-persistent-storage<br>          mountPath: /var/lib/mysql<br>      volumes:<br>      - name: mysql-persistent-storage<br>        persistentVolumeClaim:<br>          claimName: mysql-pv-claim</strong></pre><h3 name="74c5" id="74c5" class="graf graf--h3 graf-after--pre">Manifest for WordPress Deployment</h3><p name="98a8" id="98a8" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">the manifest describes a single-instance WordPress Deployment. The WordPress container mounts the PersistentVolume at /var/www/html for website data files. The WORDPRESS_DB_HOST environment variable sets the name of the MySQL Service defined above, and WordPress will access the database by Service. The WORDPRESS_DB_PASSWORD environment variable sets the database password from the Secret kustomize generated.</em></p><figure name="d453" id="d453" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 1445px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 206.4%;"></div><img class="graf-image" data-image-id="1*7Q24VPsKYjZ0N0QglxYV7w.png" data-width="904" data-height="1866" src="https://cdn-images-1.medium.com/max/800/1*7Q24VPsKYjZ0N0QglxYV7w.png"></div></figure><pre name="c090" id="c090" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong"><em class="markup--em markup--pre-em">apiVersion: v1</em><br>kind: Service<br>metadata:<br>  name: wordpress<br>  labels:<br>    app: wordpress<br>spec:<br>  ports:<br>    - port: 80<br>  selector:<br>    app: wordpress<br>    tier: frontend<br>  type: LoadBalancer<br>---<br>apiVersion: v1<br>kind: PersistentVolumeClaim<br>metadata:<br>  name: wp-pv-claim<br>  labels:<br>    app: wordpress<br>spec:<br>  accessModes:<br>    - ReadWriteOnce<br>  resources:<br>    requests:<br>      storage: 5Gi<br>---<br>apiVersion: apps/v1<br>kind: Deployment<br>metadata:<br>  name: wordpress<br>  labels:<br>    app: wordpress<br>spec:<br>  selector:<br>    matchLabels:<br>      app: wordpress<br>      tier: frontend<br>  strategy:<br>    type: Recreate<br>  template:<br>    metadata:<br>      labels:<br>        app: wordpress<br>        tier: frontend<br>    spec:<br>      containers:<br>      - image: wordpress:4.8-apache<br>        name: wordpress<br>        env:<br>        - name: WORDPRESS_DB_HOST<br>          value: wordpress-mysql<br>        - name: WORDPRESS_DB_PASSWORD<br>          valueFrom:<br>            secretKeyRef:<br>              name: mysql-pass<br>              key: password<br>        ports:<br>        - containerPort: 80<br>          name: wordpress<br>        volumeMounts:<br>        - name: wordpress-persistent-storage<br>          mountPath: /var/www/html<br>      volumes:<br>      - name: wordpress-persistent-storage<br>        persistentVolumeClaim:<br>          claimName: wp-pv-claim</strong></pre><p name="7da4" id="7da4" class="graf graf--p graf-after--pre"><em class="markup--em markup--p-em">All this environment can be set up just by using a single command</em></p><pre name="1e3f" id="1e3f" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">kubectl create -k .</strong></pre><figure name="8722" id="8722" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 287px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41%;"></div><img class="graf-image" data-image-id="1*ISaR40gywD4CSuYPaVqoXQ.png" data-width="1576" data-height="646" src="https://cdn-images-1.medium.com/max/800/1*ISaR40gywD4CSuYPaVqoXQ.png"></div></figure><pre name="905f" id="905f" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">kubectl get all</strong></pre><figure name="6a99" id="6a99" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 271px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 38.7%;"></div><img class="graf-image" data-image-id="1*jVL-1Mjx3tkf46lt-S-nXw.png" data-width="2176" data-height="842" src="https://cdn-images-1.medium.com/max/800/1*jVL-1Mjx3tkf46lt-S-nXw.png"></div><figcaption class="imageCaption">copy load balance URL and open in browser</figcaption></figure><pre name="0123" id="0123" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">kubectl get pv</strong></pre><figure name="795d" id="795d" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 142px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 20.3%;"></div><img class="graf-image" data-image-id="1*wMgqSkVhjvG1wj8Vpu1hMQ.png" data-width="2080" data-height="422" src="https://cdn-images-1.medium.com/max/800/1*wMgqSkVhjvG1wj8Vpu1hMQ.png"></div></figure><pre name="5bc9" id="5bc9" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">kubectl get pvc</strong></pre><figure name="60ed" id="60ed" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 142px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 20.3%;"></div><img class="graf-image" data-image-id="1*xvk8o_Ee-v1OCZZaU9DQBA.png" data-width="2080" data-height="422" src="https://cdn-images-1.medium.com/max/800/1*xvk8o_Ee-v1OCZZaU9DQBA.png"></div></figure><p name="b227" id="b227" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">We use the LoadBalancer External IP to use this environment</em></p><figure name="c5a0" id="c5a0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*pIlO7nSwcqWwkXpQKJ0k4A.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*pIlO7nSwcqWwkXpQKJ0k4A.png"></div><figcaption class="imageCaption">paste the load balance URL to open</figcaption></figure><figure name="d311" id="d311" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*0WhvARJtn-Q1T2XmwcFTow.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*0WhvARJtn-Q1T2XmwcFTow.png"></div><figcaption class="imageCaption">install WordPress</figcaption></figure><figure name="9fa2" id="9fa2" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*G-s7ZeSeHC5cHdMemWhInw.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*G-s7ZeSeHC5cHdMemWhInw.png"></div><figcaption class="imageCaption">login</figcaption></figure><figure name="454a" id="454a" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*2VCGQATckWTTM5ZKYFPTPg.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*2VCGQATckWTTM5ZKYFPTPg.png"></div><figcaption class="imageCaption">Dashboard</figcaption></figure><figure name="960b" id="960b" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*CGHlohmX4Wvso1BH_voaXA.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*CGHlohmX4Wvso1BH_voaXA.png"></div></figure><p name="5b25" id="5b25" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">We just developed a fully managed PHP Website without any of our local environments, the nodes are in the AWS Cloud.</em></p><h3 name="41e4" id="41e4" class="graf graf--h3 graf-after--p">Helm</h3><p name="45f7" id="45f7" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">Helm is a tool for managing Charts. Charts are packages of pre-configured Kubernetes resources.</em></p><div name="07ce" id="07ce" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://hub.helm.sh/" data-href="https://hub.helm.sh/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://hub.helm.sh/"><strong class="markup--strong markup--mixtapeEmbed-strong">Helm Hub</strong><br><em class="markup--em markup--mixtapeEmbed-em">Discover &amp; launch great Kubernetes-ready apps</em>hub.helm.sh</a><a href="https://hub.helm.sh/" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="172e219960a181201050b8e7b8f88350"></a></div><h3 name="28db" id="28db" class="graf graf--h3 graf-after--mixtapeEmbed">Uses of Helm</h3><ul class="postList"><li name="acbc" id="acbc" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">Find and use </strong><a href="https://hub.helm.sh/" data-href="https://hub.helm.sh/" class="markup--anchor markup--li-anchor" rel="noopener nofollow noopener" target="_blank"><strong class="markup--strong markup--li-strong">popular software packaged as Helm Charts</strong></a><strong class="markup--strong markup--li-strong"> to run in Kubernetes</strong></li><li name="83eb" id="83eb" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Share your own applications as Helm Charts</strong></li><li name="118c" id="118c" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Create reproducible builds of your Kubernetes applications</strong></li><li name="4c81" id="4c81" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Intelligently manage your Kubernetes manifest files</strong></li><li name="fc4f" id="fc4f" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Manage releases of Helm packages</strong></li></ul><p name="3ce6" id="3ce6" class="graf graf--p graf-after--li"><em class="markup--em markup--p-em">Simply, you can assume this as we have created our website environment. And somebody also wants to use this environment so the second person also has to do this same setup again and again. To reduce this task helm provides Kubernetes help. We can install the popular environment within a second because of the power of container and Kubernetes.</em></p><p name="593a" id="593a" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">So using the power of helm we are going to install two powerful environments one is Prometheus and the other one is Grafana. Prometheus is used to collect the metrics from the system and Grafana is a very popular Visualizing tool for Prometheus to see the system usage and many more things.</em></p><p name="5a1e" id="5a1e" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">Download and install Helm and Tiller</em></strong></p><pre name="8963" id="8963" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">helm init</strong></pre><pre name="fdf3" id="fdf3" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">helm repo add stable </strong><a href="https://kubernetes-charts.storage.googleapis.com/" data-href="https://kubernetes-charts.storage.googleapis.com/" class="markup--anchor markup--pre-anchor" rel="noopener nofollow noopener noopener" target="_blank"><strong class="markup--strong markup--pre-strong">https://kubernetes-charts.storage.googleapis.com/</strong></a></pre><pre name="1f64" id="1f64" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">helm repo list</strong></pre><pre name="45c3" id="45c3" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">helm repo update</strong></pre><figure name="0db4" id="0db4" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 212px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 30.3%;"></div><img class="graf-image" data-image-id="1*e-wfb8ZvbzMMquEk9wwGMg.png" data-width="1948" data-height="590" src="https://cdn-images-1.medium.com/max/800/1*e-wfb8ZvbzMMquEk9wwGMg.png"></div></figure><pre name="55c5" id="55c5" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">kubectl -n kube-system create serviceaccount tiller</strong></pre><pre name="c13e" id="c13e" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">kubectl create clusterrolebinding tiller --clusterrole cluster-admin --serviceaccount=kube-system:tiller</strong></pre><pre name="f89d" id="f89d" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">helm init --service-account tiller --upgrade</strong></pre><pre name="cec8" id="cec8" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">kubectl get pods --namespace kube-system</strong></pre><figure name="d144" id="d144" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 306px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.7%;"></div><img class="graf-image" data-image-id="1*NIPyhy3m6EXHJFCVVxGqtQ.png" data-width="2248" data-height="982" src="https://cdn-images-1.medium.com/max/800/1*NIPyhy3m6EXHJFCVVxGqtQ.png"></div></figure><h3 name="fd6a" id="fd6a" class="graf graf--h3 graf-after--figure">Installation Of Prometheus Chart</h3><p name="43f4" id="43f4" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">It will install the entire setup for the Prometheus environment</em></p><pre name="9e89" id="9e89" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">kubectl create namespace prometheus</strong></pre><pre name="267a" id="267a" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">helm install stable/prometheus    --namespace prometheus    --set alertmanager.persistentVolume.storageClass=&quot;gp2&quot;    --set server.persistentVolume.storageClass=&quot;gp2&quot;</strong></pre><figure name="9ac6" id="9ac6" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 481px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68.7%;"></div><img class="graf-image" data-image-id="1*22DCQARnsd1luI8OqN_ObQ.png" data-width="2164" data-height="1486" src="https://cdn-images-1.medium.com/max/800/1*22DCQARnsd1luI8OqN_ObQ.png"></div></figure><pre name="4bac" id="4bac" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">kubectl get all -n prometheus</strong></pre><figure name="f423" id="f423" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 381px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 54.400000000000006%;"></div><img class="graf-image" data-image-id="1*d52fLsUYkEvbb-79TeYrPQ.png" data-width="2164" data-height="1178" src="https://cdn-images-1.medium.com/max/800/1*d52fLsUYkEvbb-79TeYrPQ.png"></div></figure><pre name="3a64" id="3a64" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">kubectl -n prometheus  port-forward svc/service/prometheus-15943361830-server  8888:80</strong></pre><figure name="9c10" id="9c10" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 182px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 26%;"></div><img class="graf-image" data-image-id="1*KNrJOp3reaXm2o_CYkJMSA.png" data-width="2164" data-height="562" src="https://cdn-images-1.medium.com/max/800/1*KNrJOp3reaXm2o_CYkJMSA.png"></div></figure><figure name="e44e" id="e44e" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*__Vecdic7kk62K4RpRspVQ.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*__Vecdic7kk62K4RpRspVQ.png"></div></figure><h3 name="cdeb" id="cdeb" class="graf graf--h3 graf-after--figure">Installation Of Grafana Chart</h3><pre name="079d" id="079d" class="graf graf--pre graf-after--h3"><strong class="markup--strong markup--pre-strong">kubectl create namespace grafana</strong></pre><pre name="7d1e" id="7d1e" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">helm install stable/grafana  --namespace grafana     --set persistence.storageClassName=&quot;gp2&quot; --set adminPassword=MyPass --set service.type=LoadBalancer</strong></pre><figure name="eb8d" id="eb8d" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 403px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 57.599999999999994%;"></div><img class="graf-image" data-image-id="1*VsFh_0dzw8hmm6aSStTp-Q.png" data-width="1948" data-height="1122" src="https://cdn-images-1.medium.com/max/800/1*VsFh_0dzw8hmm6aSStTp-Q.png"></div></figure><pre name="ffad" id="ffad" class="graf graf--pre graf-after--figure"><strong class="markup--strong markup--pre-strong">kubectl get all -n grafana</strong></pre><figure name="9b7e" id="9b7e" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 207px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 29.5%;"></div><img class="graf-image" data-image-id="1*9Yyc1S3u4G5QKLmxkXjCSA.png" data-width="2188" data-height="646" src="https://cdn-images-1.medium.com/max/800/1*9Yyc1S3u4G5QKLmxkXjCSA.png"></div><figcaption class="imageCaption">copy the external IP</figcaption></figure><figure name="55ab" id="55ab" class="graf graf--figure graf-after--figure"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*d-gRZRyi04eD6xPDdKiqKA.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*d-gRZRyi04eD6xPDdKiqKA.png"></div><figcaption class="imageCaption">open with external IP</figcaption></figure><p name="347e" id="347e" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">Get your ‘admin’ user password by running:</strong></p><pre name="cbcd" id="cbcd" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">kubectl get secret — namespace grafana grafana-1594403593 -o jsonpath=”{.data.admin-password}” | base64 — decode ; echo</strong></pre><figure name="2d1b" id="2d1b" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 153px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 21.8%;"></div><img class="graf-image" data-image-id="1*HmoWBWT6TAjZMoSJvKsTFQ.png" data-width="2188" data-height="478" src="https://cdn-images-1.medium.com/max/800/1*HmoWBWT6TAjZMoSJvKsTFQ.png"></div><figcaption class="imageCaption">Password — MyPass</figcaption></figure><p name="6a20" id="6a20" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Login with the password from the above and the username: </em><strong class="markup--strong markup--p-strong"><em class="markup--em markup--p-em">admin</em></strong></p><figure name="c3b3" id="c3b3" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="1*lPSKLvC5v-WwtX88Mu-1Hg.png" data-width="2872" data-height="1870" src="https://cdn-images-1.medium.com/max/800/1*lPSKLvC5v-WwtX88Mu-1Hg.png"></div><figcaption class="imageCaption">Dashboard</figcaption></figure><h3 name="a2b0" id="a2b0" class="graf graf--h3 graf-after--figure">Deleting Cluster</h3><pre name="1f1a" id="1f1a" class="graf graf--pre graf-after--h3"><strong class="markup--strong markup--pre-strong">eksctl delete cluster -f cluster.yml</strong></pre><p name="5bd9" id="5bd9" class="graf graf--p graf-after--pre">It will delete you entire setup you have created.</p><figure name="4acb" id="4acb" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 280px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 40%;"></div><img class="graf-image" data-image-id="1*VwnHO8-K3mBIxZP3eDhcnA.png" data-width="1684" data-height="674" src="https://cdn-images-1.medium.com/max/800/1*VwnHO8-K3mBIxZP3eDhcnA.png"></div></figure><h4 name="bb3f" id="bb3f" class="graf graf--h4 graf-after--figure">Github link for all the YAML files</h4><div name="7c38" id="7c38" class="graf graf--mixtapeEmbed graf-after--h4 graf--trailing"><a href="https://github.com/Pasupuleti-rajesh-babu/aws-eks" data-href="https://github.com/Pasupuleti-rajesh-babu/aws-eks" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/Pasupuleti-rajesh-babu/aws-eks"><strong class="markup--strong markup--mixtapeEmbed-strong">Pasupuleti-rajesh-babu/aws-eks</strong><br><em class="markup--em markup--mixtapeEmbed-em">Contribute to Pasupuleti-rajesh-babu/aws-eks development by creating an account on GitHub.</em>github.com</a><a href="https://github.com/Pasupuleti-rajesh-babu/aws-eks" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="0378a0e388fc622aa5bafe23d0fcd767" data-thumbnail-img-id="0*YP9ZGjFbJjQ_mgnk" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*YP9ZGjFbJjQ_mgnk);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@p.rajeshbabu6666" class="p-author h-card">Pasupulati Rajesh Babu</a> on <a href="https://medium.com/p/21ef76659aaf"><time class="dt-published" datetime="2020-07-10T03:23:27.612Z">July 10, 2020</time></a>.</p><p><a href="https://medium.com/@p.rajeshbabu6666/amazon-elastic-kubernetes-service-amazon-eks-is-a-managed-service-that-makes-it-easy-for-you-to-21ef76659aaf" class="p-canonical">Canonical link</a></p>
